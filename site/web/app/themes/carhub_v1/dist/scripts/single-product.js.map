{"version":3,"sources":["../assets/scripts/single-product.js"],"names":["jQuery","$","wc_single_product_params","on","hide","hash","window","location","url","href","$tabs","this","find","first","toLowerCase","indexOf","click","e","preventDefault","$tab","$tabs_wrapper","closest","removeClass","addClass","attr","show","before","$star","$rating","$container","val","text","siblings","rating","length","review_rating_required","alert","i18n_required_rating_text","trigger","ProductGallery","$target","args","$images","css","data","flexslider_enabled","isFunction","fn","flexslider","zoom_enabled","zoom","photoswipe_enabled","PhotoSwipe","initFlexslider","bind","initZoom","initPhotoswipe","onResetSlidePosition","getGalleryItems","openPhotoswipe","prototype","images","selector","animation","smoothHeight","directionNav","controlNav","slideshow","animationSpeed","animationLoop","start","largest_height","each","height","zoomTarget","galleryWidth","width","zoomEnabled","index","target","zoom_options","touch","prepend","$slides","items","i","el","img","large_image_src","large_image_w","large_image_h","item","src","w","h","title","push","clicked","pswpElement","eventTarget","is","options","shareEl","closeOnScroll","history","hideAnimationDuration","showAnimationDuration","PhotoSwipeUI_Default","init","wc_product_gallery"],"mappings":"AACAA,OAAA,SAAAC,GAGA,GAAA,mBAAAC,0BACA,OAAA,CAGAD,GAAA,QAEAE,GAAA,OAAA,sCAAA,WACAF,EAAA,wDAAAG,MAEA,IAAAC,GAAAC,OAAAC,SAAAF,KACAG,EAAAF,OAAAC,SAAAE,KACAC,EAAAT,EAAAU,MAAAC,KAAA,qBAAAC,OAEAR,GAAAS,cAAAC,QAAA,aAAA,GAAA,aAAAV,GAAA,iBAAAA,EACAK,EAAAE,KAAA,oBAAAI,QACAR,EAAAO,QAAA,iBAAA,GAAAP,EAAAO,QAAA,UAAA,EACAL,EAAAE,KAAA,oBAAAI,QAEAN,EAAAE,KAAA,cAAAI,UAGAb,GAAA,QAAA,8BAAA,SAAAc,GACAA,EAAAC,gBACA,IAAAC,GAAAlB,EAAAU,MACAS,EAAAD,EAAAE,QAAA,sCACAD,GAAAR,KAAA,qBAEAA,KAAA,MAAAU,YAAA,UACAF,EAAAR,KAAA,sCAAAR,OAEAe,EAAAE,QAAA,MAAAE,SAAA,UACAH,EAAAR,KAAAO,EAAAK,KAAA,SAAAC,SAGAtB,GAAA,QAAA,4BAAA,WAEA,MADAF,GAAA,kBAAAe,SACA,IAGAb,GAAA,OAAA,UAAA,WACAF,EAAA,WAAAG,OAAAsB,OAAA,wMAEAvB,GAAA,QAAA,qBAAA,WACA,GAAAwB,GAAA1B,EAAAU,MACAiB,EAAA3B,EAAAU,MAAAU,QAAA,YAAAT,KAAA,WACAiB,EAAA5B,EAAAU,MAAAU,QAAA,SAOA,OALAO,GAAAE,IAAAH,EAAAI,QACAJ,EAAAK,SAAA,KAAAV,YAAA,UACAK,EAAAJ,SAAA,UACAM,EAAAN,SAAA,aAEA,IAEApB,GAAA,QAAA,mBAAA,WACA,GAAAyB,GAAA3B,EAAAU,MAAAU,QAAA,YAAAT,KAAA,WACAqB,EAAAL,EAAAE,KAEA,IAAAF,EAAAM,OAAA,IAAAD,GAAA,QAAA/B,yBAAAiC,uBAGA,MAFA7B,QAAA8B,MAAAlC,yBAAAmC,4BAEA,IAKApC,EAAA,gDAAAqC,QAAA,OAKA,IAAAC,GAAA,SAAAC,EAAAC,GAKA,GAJA9B,KAAA6B,QAAAA,EACA7B,KAAA+B,QAAAzC,EAAA,sCAAAuC,GAGA,IAAA7B,KAAA+B,QAAAR,OAEA,WADAvB,MAAA6B,QAAAG,IAAA,UAAA,EAKAH,GAAAI,KAAA,kBAAAjC,MAGAA,KAAAkC,mBAAA5C,EAAA6C,WAAA7C,EAAA8C,GAAAC,aAAA9C,yBAAA2C,mBACAlC,KAAAsC,aAAAhD,EAAA6C,WAAA7C,EAAA8C,GAAAG,OAAAhD,yBAAA+C,aACAtC,KAAAwC,mBAAA,mBAAAC,aAAAlD,yBAAAiD,mBAGAV,IACA9B,KAAAkC,oBAAA,IAAAJ,EAAAI,oBAAAlC,KAAAkC,mBACAlC,KAAAsC,cAAA,IAAAR,EAAAQ,cAAAtC,KAAAsC,aACAtC,KAAAwC,oBAAA,IAAAV,EAAAU,oBAAAxC,KAAAwC,oBAIAxC,KAAA0C,eAAA1C,KAAA0C,eAAAC,KAAA3C,MACAA,KAAA4C,SAAA5C,KAAA4C,SAAAD,KAAA3C,MACAA,KAAA6C,eAAA7C,KAAA6C,eAAAF,KAAA3C,MACAA,KAAA8C,qBAAA9C,KAAA8C,qBAAAH,KAAA3C,MACAA,KAAA+C,gBAAA/C,KAAA+C,gBAAAJ,KAAA3C,MACAA,KAAAgD,eAAAhD,KAAAgD,eAAAL,KAAA3C,MAEAA,KAAAkC,oBACAlC,KAAA0C,iBACAb,EAAArC,GAAA,2CAAAQ,KAAA8C,uBAEA9C,KAAA6B,QAAAG,IAAA,UAAA,GAGAhC,KAAAsC,eACAtC,KAAA4C,WACAf,EAAArC,GAAA,gCAAAQ,KAAA4C,WAGA5C,KAAAwC,oBACAxC,KAAA6C,iBAOAjB,GAAAqB,UAAAP,eAAA,WACA,GAAAQ,GAAAlD,KAAA+B,QACAF,EAAA7B,KAAA6B,OAEAA,GAAAQ,YACAc,SAAA,8EACAC,UAAA7D,yBAAA8C,WAAAe,UACAC,aAAA9D,yBAAA8C,WAAAgB,aACAC,aAAA/D,yBAAA8C,WAAAiB,aACAC,WAAAhE,yBAAA8C,WAAAkB,WACAC,UAAAjE,yBAAA8C,WAAAmB,UACAC,eAAAlE,yBAAA8C,WAAAoB,eACAC,cAAAnE,yBAAA8C,WAAAqB,cACAC,MAAA,WACA9B,EAAAG,IAAA,UAAA,EAEA,IAAA4B,GAAA,CAEAV,GAAAW,KAAA,WACA,GAAAC,GAAAxE,EAAAU,MAAA8D,QAEAA,GAAAF,IACAA,EAAAE,KAIAZ,EAAAW,KAAA,WACAvE,EAAAU,MAAAgC,IAAA,aAAA4B,SASAhC,EAAAqB,UAAAL,SAAA,WACA,GAAAmB,GAAA/D,KAAA+B,QACAiC,EAAAhE,KAAA6B,QAAAoC,QACAC,GAAA,CAgBA,IAdAlE,KAAAkC,qBACA6B,EAAAA,EAAA7D,SAGAZ,EAAAyE,GAAAF,KAAA,SAAAM,EAAAC,GAGA,GAFA9E,EAAA8E,GAAAnE,KAAA,OAEAgC,KAAA,qBAAA+B,EAEA,MADAE,IAAA,GACA,IAKAA,EAAA,CACA,GAAAG,IACAC,OAAA,EAGA,iBAAA3E,UACA0E,EAAA7E,GAAA,SAGAuE,EAAApC,QAAA,gBACAoC,EAAAxB,KAAA8B,KAOAzC,EAAAqB,UAAAJ,eAAA,WACA7C,KAAAsC,cAAAtC,KAAA+B,QAAAR,OAAA,IACAvB,KAAA6B,QAAA0C,QAAA,mEACAvE,KAAA6B,QAAArC,GAAA,QAAA,wCAAAQ,KAAAgD,iBAEAhD,KAAA6B,QAAArC,GAAA,QAAA,wCAAAQ,KAAAgD,iBAMApB,EAAAqB,UAAAH,qBAAA,WACA9C,KAAA6B,QAAAQ,WAAA,IAMAT,EAAAqB,UAAAF,gBAAA,WACA,GAAAyB,GAAAxE,KAAA+B,QACA0C,IAkBA,OAhBAD,GAAAjD,OAAA,GACAiD,EAAAX,KAAA,SAAAa,EAAAC,GACA,GAAAC,GAAAtF,EAAAqF,GAAA1E,KAAA,OACA4E,EAAAD,EAAA/D,KAAA,oBACAiE,EAAAF,EAAA/D,KAAA,0BACAkE,EAAAH,EAAA/D,KAAA,2BACAmE,GACAC,IAAAJ,EACAK,EAAAJ,EACAK,EAAAJ,EACAK,MAAAR,EAAA/D,KAAA,SAEA4D,GAAAY,KAAAL,KAIAP,GAMA7C,EAAAqB,UAAAD,eAAA,SAAA1C,GACAA,EAAAC,gBAEA,IAGA+E,GAHAC,EAAAjG,EAAA,SAAA,GACAmF,EAAAzE,KAAA+C,kBACAyC,EAAAlG,EAAAgB,EAAA8D,OAMAkB,GAHAE,EAAAC,GAAA,yCAGAzF,KAAA6B,QAAA5B,KAAA,sBAFAuF,EAAA9E,QAAA,sCAKA,IAAAgF,IACAvB,MAAA7E,EAAAgG,GAAAnB,QACAwB,SAAA,EACAC,eAAA,EACAC,SAAA,EACAC,sBAAA,EACAC,sBAAA,EAIA,IAAAtD,YAAA8C,EAAAS,qBAAAvB,EAAAiB,GACAO,QAMA3G,EAAA8C,GAAA8D,mBAAA,SAAApE,GAEA,MADA,IAAAF,GAAA5B,KAAA8B,GACA9B,MAMAV,EAAA,gCAAAuE,KAAA,WACAvE,EAAAU,MAAAkG","file":"single-product.js","sourcesContent":["/*global wc_single_product_params, PhotoSwipe, PhotoSwipeUI_Default */\njQuery( function( $ ) {\n\n\t// wc_single_product_params is required to continue.\n\tif ( typeof wc_single_product_params === 'undefined' ) {\n\t\treturn false;\n\t}\n\n\t$( 'body' )\n\t\t// Tabs\n\t\t.on( 'init', '.wc-tabs-wrapper, .woocommerce-tabs', function() {\n\t\t\t$( '.wc-tab, .woocommerce-tabs .panel:not(.panel .panel)' ).hide();\n\n\t\t\tvar hash  = window.location.hash;\n\t\t\tvar url   = window.location.href;\n\t\t\tvar $tabs = $( this ).find( '.wc-tabs, ul.tabs' ).first();\n\n\t\t\tif ( hash.toLowerCase().indexOf( 'comment-' ) >= 0 || hash === '#reviews' || hash === '#tab-reviews' ) {\n\t\t\t\t$tabs.find( 'li.reviews_tab a' ).click();\n\t\t\t} else if ( url.indexOf( 'comment-page-' ) > 0 || url.indexOf( 'cpage=' ) > 0 ) {\n\t\t\t\t$tabs.find( 'li.reviews_tab a' ).click();\n\t\t\t} else {\n\t\t\t\t$tabs.find( 'li:first a' ).click();\n\t\t\t}\n\t\t} )\n\t\t.on( 'click', '.wc-tabs li a, ul.tabs li a', function( e ) {\n\t\t\te.preventDefault();\n\t\t\tvar $tab          = $( this );\n\t\t\tvar $tabs_wrapper = $tab.closest( '.wc-tabs-wrapper, .woocommerce-tabs' );\n\t\t\tvar $tabs         = $tabs_wrapper.find( '.wc-tabs, ul.tabs' );\n\n\t\t\t$tabs.find( 'li' ).removeClass( 'active' );\n\t\t\t$tabs_wrapper.find( '.wc-tab, .panel:not(.panel .panel)' ).hide();\n\n\t\t\t$tab.closest( 'li' ).addClass( 'active' );\n\t\t\t$tabs_wrapper.find( $tab.attr( 'href' ) ).show();\n\t\t} )\n\t\t// Review link\n\t\t.on( 'click', 'a.woocommerce-review-link', function() {\n\t\t\t$( '.reviews_tab a' ).click();\n\t\t\treturn true;\n\t\t} )\n\t\t// Star ratings for comments\n\t\t.on( 'init', '#rating', function() {\n\t\t\t$( '#rating' ).hide().before( '<p class=\"stars\"><span><a class=\"star-1\" href=\"#\">1</a><a class=\"star-2\" href=\"#\">2</a><a class=\"star-3\" href=\"#\">3</a><a class=\"star-4\" href=\"#\">4</a><a class=\"star-5\" href=\"#\">5</a></span></p>' );\n\t\t} )\n\t\t.on( 'click', '#respond p.stars a', function() {\n\t\t\tvar $star   \t= $( this ),\n\t\t\t\t$rating \t= $( this ).closest( '#respond' ).find( '#rating' ),\n\t\t\t\t$container \t= $( this ).closest( '.stars' );\n\n\t\t\t$rating.val( $star.text() );\n\t\t\t$star.siblings( 'a' ).removeClass( 'active' );\n\t\t\t$star.addClass( 'active' );\n\t\t\t$container.addClass( 'selected' );\n\n\t\t\treturn false;\n\t\t} )\n\t\t.on( 'click', '#respond #submit', function() {\n\t\t\tvar $rating = $( this ).closest( '#respond' ).find( '#rating' ),\n\t\t\t\trating  = $rating.val();\n\n\t\t\tif ( $rating.length > 0 && ! rating && wc_single_product_params.review_rating_required === 'yes' ) {\n\t\t\t\twindow.alert( wc_single_product_params.i18n_required_rating_text );\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\n\t// Init Tabs and Star Ratings\n\t$( '.wc-tabs-wrapper, .woocommerce-tabs, #rating' ).trigger( 'init' );\n\n\t/**\n\t * Product gallery class.\n\t */\n\tvar ProductGallery = function( $target, args ) {\n\t\tthis.$target = $target;\n\t\tthis.$images = $( '.woocommerce-product-gallery__image', $target );\n\n\t\t// No images? Abort.\n\t\tif ( 0 === this.$images.length ) {\n\t\t\tthis.$target.css( 'opacity', 1 );\n\t\t\treturn;\n\t\t}\n\n\t\t// Make this object available.\n\t\t$target.data( 'product_gallery', this );\n\n\t\t// Pick functionality to initialize...\n\t\tthis.flexslider_enabled = $.isFunction( $.fn.flexslider ) && wc_single_product_params.flexslider_enabled;\n\t\tthis.zoom_enabled       = $.isFunction( $.fn.zoom ) && wc_single_product_params.zoom_enabled;\n\t\tthis.photoswipe_enabled = typeof PhotoSwipe !== 'undefined' && wc_single_product_params.photoswipe_enabled;\n\n\t\t// ...also taking args into account.\n\t\tif ( args ) {\n\t\t\tthis.flexslider_enabled = false === args.flexslider_enabled ? false : this.flexslider_enabled;\n\t\t\tthis.zoom_enabled       = false === args.zoom_enabled ? false : this.zoom_enabled;\n\t\t\tthis.photoswipe_enabled = false === args.photoswipe_enabled ? false : this.photoswipe_enabled;\n\t\t}\n\n\t\t// Bind functions to this.\n\t\tthis.initFlexslider       = this.initFlexslider.bind( this );\n\t\tthis.initZoom             = this.initZoom.bind( this );\n\t\tthis.initPhotoswipe       = this.initPhotoswipe.bind( this );\n\t\tthis.onResetSlidePosition = this.onResetSlidePosition.bind( this );\n\t\tthis.getGalleryItems      = this.getGalleryItems.bind( this );\n\t\tthis.openPhotoswipe       = this.openPhotoswipe.bind( this );\n\n\t\tif ( this.flexslider_enabled ) {\n\t\t\tthis.initFlexslider();\n\t\t\t$target.on( 'woocommerce_gallery_reset_slide_position', this.onResetSlidePosition );\n\t\t} else {\n\t\t\tthis.$target.css( 'opacity', 1 );\n\t\t}\n\n\t\tif ( this.zoom_enabled ) {\n\t\t\tthis.initZoom();\n\t\t\t$target.on( 'woocommerce_gallery_init_zoom', this.initZoom );\n\t\t}\n\n\t\tif ( this.photoswipe_enabled ) {\n\t\t\tthis.initPhotoswipe();\n\t\t}\n\t};\n\n\t/**\n\t * Initialize flexSlider.\n\t */\n\tProductGallery.prototype.initFlexslider = function() {\n\t\tvar images  = this.$images,\n\t\t\t$target = this.$target;\n\n\t\t$target.flexslider( {\n\t\t\tselector:       '.woocommerce-product-gallery__wrapper > .woocommerce-product-gallery__image',\n\t\t\tanimation:      wc_single_product_params.flexslider.animation,\n\t\t\tsmoothHeight:   wc_single_product_params.flexslider.smoothHeight,\n\t\t\tdirectionNav:   wc_single_product_params.flexslider.directionNav,\n\t\t\tcontrolNav:     wc_single_product_params.flexslider.controlNav,\n\t\t\tslideshow:      wc_single_product_params.flexslider.slideshow,\n\t\t\tanimationSpeed: wc_single_product_params.flexslider.animationSpeed,\n\t\t\tanimationLoop:  wc_single_product_params.flexslider.animationLoop, // Breaks photoswipe pagination if true.\n\t\t\tstart: function() {\n\t\t\t\t$target.css( 'opacity', 1 );\n\n\t\t\t\tvar largest_height = 0;\n\n\t\t\t\timages.each( function() {\n\t\t\t\t\tvar height = $( this ).height();\n\n\t\t\t\t\tif ( height > largest_height ) {\n\t\t\t\t\t\tlargest_height = height;\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\timages.each( function() {\n\t\t\t\t\t$( this ).css( 'min-height', largest_height );\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t};\n\n\t/**\n\t * Init zoom.\n\t */\n\tProductGallery.prototype.initZoom = function() {\n\t\tvar zoomTarget   = this.$images,\n\t\t\tgalleryWidth = this.$target.width(),\n\t\t\tzoomEnabled  = false;\n\n\t\tif ( ! this.flexslider_enabled ) {\n\t\t\tzoomTarget = zoomTarget.first();\n\t\t}\n\n\t\t$( zoomTarget ).each( function( index, target ) {\n\t\t\tvar image = $( target ).find( 'img' );\n\n\t\t\tif ( image.data( 'large_image_width' ) > galleryWidth ) {\n\t\t\t\tzoomEnabled = true;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\n\t\t// But only zoom if the img is larger than its container.\n\t\tif ( zoomEnabled ) {\n\t\t\tvar zoom_options = {\n\t\t\t\ttouch: false\n\t\t\t};\n\n\t\t\tif ( 'ontouchstart' in window ) {\n\t\t\t\tzoom_options.on = 'click';\n\t\t\t}\n\n\t\t\tzoomTarget.trigger( 'zoom.destroy' );\n\t\t\tzoomTarget.zoom( zoom_options );\n\t\t}\n\t};\n\n\t/**\n\t * Init PhotoSwipe.\n\t */\n\tProductGallery.prototype.initPhotoswipe = function() {\n\t\tif ( this.zoom_enabled && this.$images.length > 0 ) {\n\t\t\tthis.$target.prepend( '<a href=\"#\" class=\"woocommerce-product-gallery__trigger\">🔍</a>' );\n\t\t\tthis.$target.on( 'click', '.woocommerce-product-gallery__trigger', this.openPhotoswipe );\n\t\t}\n\t\tthis.$target.on( 'click', '.woocommerce-product-gallery__image a', this.openPhotoswipe );\n\t};\n\n\t/**\n\t * Reset slide position to 0.\n\t */\n\tProductGallery.prototype.onResetSlidePosition = function() {\n\t\tthis.$target.flexslider( 0 );\n\t};\n\n\t/**\n\t * Get product gallery image items.\n\t */\n\tProductGallery.prototype.getGalleryItems = function() {\n\t\tvar $slides = this.$images,\n\t\t\titems   = [];\n\n\t\tif ( $slides.length > 0 ) {\n\t\t\t$slides.each( function( i, el ) {\n\t\t\t\tvar img = $( el ).find( 'img' ),\n\t\t\t\t\tlarge_image_src = img.attr( 'data-large_image' ),\n\t\t\t\t\tlarge_image_w   = img.attr( 'data-large_image_width' ),\n\t\t\t\t\tlarge_image_h   = img.attr( 'data-large_image_height' ),\n\t\t\t\t\titem            = {\n\t\t\t\t\t\tsrc: large_image_src,\n\t\t\t\t\t\tw:   large_image_w,\n\t\t\t\t\t\th:   large_image_h,\n\t\t\t\t\t\ttitle: img.attr( 'title' )\n\t\t\t\t\t};\n\t\t\t\titems.push( item );\n\t\t\t} );\n\t\t}\n\n\t\treturn items;\n\t};\n\n\t/**\n\t * Open photoswipe modal.\n\t */\n\tProductGallery.prototype.openPhotoswipe = function( e ) {\n\t\te.preventDefault();\n\n\t\tvar pswpElement = $( '.pswp' )[0],\n\t\t\titems       = this.getGalleryItems(),\n\t\t\teventTarget = $( e.target ),\n\t\t\tclicked;\n\n\t\tif ( ! eventTarget.is( '.woocommerce-product-gallery__trigger' ) ) {\n\t\t\tclicked = eventTarget.closest( '.woocommerce-product-gallery__image' );\n\t\t} else {\n\t\t\tclicked = this.$target.find( '.flex-active-slide' );\n\t\t}\n\n\t\tvar options = {\n\t\t\tindex:                 $( clicked ).index(),\n\t\t\tshareEl:               false,\n\t\t\tcloseOnScroll:         false,\n\t\t\thistory:               false,\n\t\t\thideAnimationDuration: 0,\n\t\t\tshowAnimationDuration: 0\n\t\t};\n\n\t\t// Initializes and opens PhotoSwipe.\n\t\tvar photoswipe = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options );\n\t\tphotoswipe.init();\n\t};\n\n\t/**\n\t * Function to call wc_product_gallery on jquery selector.\n\t */\n\t$.fn.wc_product_gallery = function( args ) {\n\t\tnew ProductGallery( this, args );\n\t\treturn this;\n\t};\n\n\t/*\n\t * Initialize all galleries on page.\n\t */\n\t$( '.woocommerce-product-gallery' ).each( function() {\n\t\t$( this ).wc_product_gallery();\n\t} );\n} );\n"],"sourceRoot":"assets/scripts/"}